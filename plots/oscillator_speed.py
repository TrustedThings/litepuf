from statistics import mean
import matplotlib
import matplotlib.pyplot as plt
from matplotlib.ticker import EngFormatter

# matplotlib.use("pgf")
# matplotlib.rcParams.update({
#     "pgf.texsystem": "pdflatex",
#     'font.family': 'serif',
#     'text.usetex': True,
#     'pgf.rcfonts': False,
# })

# data collected using examples/oscillator_client.py
data = {
    1: [2163530824, 2163293493, 2163564223, 2162644365, 2163148853, 2163424821, 2163743770, 2163497958, 2162625773, 2162945419, 2163884537, 2163374355, 2163755421, 2163564333, 2163443489, 2163375271, 2163537996, 2163401198, 2163576088, 2162172271, 2163900043, 2162746482, 2163766318, 2163422077, 2162384779, 2163135345, 2162953630, 2163148596, 2162980383, 2163064910, 2163280947, 2163354958, 2163696390, 2162877566, 2163680184, 2162985670, 2162773444, 2162745379, 2163205932, 2163773705, 2162966310, 2163355975, 2163349363, 2163523770, 2162938182, 2163172957, 2163662544, 2163777024, 2163836483, 2163677793, 2163713881, 2163199159, 2162924571, 2163509462, 2163078184, 2162915976, 2162743488, 2163461195, 2163281947, 2163313032, 2163239660, 2163180722, 2163698114, 2163283757, 2161641950, 2162980375, 2163117229, 2163935275, 2164006858, 2163662419, 2163644373, 2162256075, 2164182909, 2164182462, 2164173182, 2163708308, 2162735224, 2163549580, 2163799191, 2163471302, 2163307784, 2163483021, 2164080412, 2163507423, 2161749385, 2163730246, 2163508480, 2163609707, 2164293864, 2163769267, 2163764723, 2163872060, 2164062022, 2163601698, 2162612824, 2162815465, 2163908809, 2164100303, 2164043354, 2163659381],
    2: [561559050, 561305959, 561391770, 561320856, 561528224, 561614376, 561591613, 561502044, 561424471, 561533018, 561661557, 561457169, 561594672, 561551028, 561551941, 561521744, 561520588, 561372295, 561479384, 561487721, 561564850, 561564865, 561594222, 561353576, 561534284, 561321265, 561648224, 561610693, 561583169, 561601243, 561525380, 561491221, 561605116, 561593062, 561605392, 561535234, 561561456, 561539849, 561488091, 561515857, 561569875, 561516209, 561628860, 561663657, 561466349, 561374099, 561534521, 561557767, 561328034, 561317984, 561464671, 561493247, 561293982, 561495939, 561550830, 561594251, 561494596, 561576261, 561591250, 561371947, 561581702, 561664375, 561588748, 561568484, 561571771, 561540675, 561581865, 561486561, 561539486, 561568100, 561378378, 561316000, 561464660, 561428138, 561302055, 561405853, 561449340, 561532444, 561500267, 561468209, 561540104, 561530956, 561513947, 561496873, 561515165, 561388288, 561460523, 561488530, 561461300, 561392693, 561373054, 561270417, 561294403, 561299558, 561219604, 561383460, 561472337, 561423107, 561423126, 561539857],
    3: [334024286, 334042276, 334018071, 334026822, 334038663, 334054500, 334033605, 334013193, 334036169, 334050336, 334040709, 334063501, 334065068, 334041335, 334040023, 334085414, 334062668, 334091587, 334066694, 334038065, 334059809, 334045369, 334021804, 334025535, 334024873, 334077086, 334064609, 334077409, 334049139, 334065129, 334089434, 334119536, 334087721, 334046892, 334048421, 334122303, 334126577, 334108257, 334111696, 334111031, 334110884, 334115862, 334096870, 334093692, 334107733, 334110832, 334116006, 334127670, 334094844, 334116174, 334107817, 334088541, 334086156, 334077853, 334091135, 334092741, 334081882, 334103751, 334070201, 334074598, 334107344, 334098201, 334106483, 334110269, 334106789, 334118580, 334098868, 334042765, 334056639, 334056747, 334071337, 334066644, 334021305, 334010911, 334029246, 334043649, 334078047, 334067634, 334065456, 334077379, 334080766, 334090654, 334106019, 334098728, 334090690, 334100423, 334100656, 334088555, 334061466, 334084113, 334103945, 334127427, 334087126, 334080825, 334081014, 334110532, 334083195, 334105567, 334094914, 334102161],
    4: [235514254, 235521152, 235536763, 235557411, 235577693, 235549904, 235558173, 235535807, 235526412, 235558299, 235565298, 235569899, 235560329, 235516932, 235556740, 235533579, 235540136, 235534740, 235521605, 235546733, 235545944, 235542089, 235554173, 235567187, 235571952, 235565912, 235570288, 235547564, 235563299, 235540815, 235545011, 235553655, 235555567, 235536152, 235550548, 235553180, 235540761, 235493808, 235529554, 235528277, 235549279, 235527080, 235531988, 235514040, 235545097, 235544558, 235529716, 235543112, 235581300, 235558868, 235530319, 235537675, 235559598, 235537483, 235558620, 235560285, 235576197, 235580930, 235566522, 235555703, 235517412, 235531728, 235553337, 235555686, 235517890, 235543577, 235504636, 235530351, 235538545, 235520127, 235503111, 235504724, 235497386, 235521302, 235558151, 235572984, 235535069, 235561529, 235552709, 235519086, 235542008, 235560063, 235533314, 235541870, 235551564, 235548145, 235533482, 235534496, 235545118, 235576446, 235547555, 235549275, 235559326, 235543305, 235534729, 235544079, 235561665, 235556991, 235544350, 235547944],
    5: [197879657, 197872990, 197875130, 197869482, 197882776, 197889446, 197862534, 197862794, 197866670, 197865056, 197885837, 197872850, 197886372, 197878524, 197888412, 197887288, 197893083, 197892041, 197889356, 197877495, 197893062, 197903951, 197901510, 197909813, 197889084, 197881401, 197881891, 197893138, 197893175, 197887331, 197908644, 197900862, 197904514, 197897316, 197881416, 197885988, 197887236, 197908039, 197921653, 197907339, 197929923, 197884334, 197904810, 197901218, 197912283, 197909642, 197926446, 197914441, 197907262, 197922820, 197917686, 197898060, 197892837, 197897810, 197914348, 197910843, 197903703, 197894492, 197921614, 197918609, 197901419, 197916469, 197908723, 197881148, 197900294, 197915542, 197899604, 197906428, 197914849, 197900650, 197906636, 197920738, 197892531, 197906624, 197903557, 197916189, 197911225, 197912068, 197913251, 197900665, 197906583, 197918303, 197926458, 197928875, 197911685, 197910145, 197919219, 197912778, 197897643, 197902245, 197903385, 197898183, 197904098, 197904937, 197920867, 197906910, 197903503, 197917377, 197911170, 197916018],
    6: [160286083, 160284001, 160295925, 160298992, 160288572, 160284626, 160284780, 160283269, 160291000, 160296244, 160290425, 160279599, 160290477, 160307517, 160289094, 160301902, 160299435, 160297858, 160292956, 160299500, 160299015, 160291175, 160284160, 160300619, 160299729, 160293385, 160300481, 160299896, 160298890, 160300945, 160300574, 160299284, 160291204, 160286943, 160284971, 160286119, 160271358, 160286746, 160279751, 160297946, 160306165, 160305778, 160296742, 160293511, 160302934, 160301096, 160310799, 160318784, 160307586, 160321459, 160297041, 160308360, 160284030, 160289689, 160286459, 160281097, 160290391, 160287989, 160286503, 160299287, 160312189, 160304069, 160299151, 160290085, 160298652, 160302669, 160308656, 160305965, 160289391, 160300197, 160302210, 160309208, 160308523, 160311120, 160301058, 160294054, 160298614, 160316436, 160318592, 160315429, 160317237, 160320331, 160296515, 160299419, 160294325, 160300515, 160304201, 160304303, 160296677, 160304251, 160298681, 160302282, 160306361, 160310841, 160324348, 160323780, 160325752, 160324541, 160325542, 160325793],
    7: [143472121, 143459211, 143467913, 143461206, 143476404, 143478478, 143449897, 143453815, 143451414, 143462900, 143445750, 143443384, 143453771, 143441669, 143450837, 143452974, 143445330, 143452109, 143434667, 143435483, 143443158, 143441631, 143439187, 143439759, 143430782, 143434894, 143439358, 143439757, 143437784, 143439723, 143455115, 143442699, 143445393, 143436299, 143439211, 143447737, 143442459, 143446018, 143434539, 143450363, 143439607, 143432952, 143439484, 143435598, 143429007, 143429638, 143427598, 143435266, 143443314, 143447332, 143448252, 143444273, 143448845, 143446321, 143449399, 143434950, 143435709, 143442191, 143444635, 143443554, 143436753, 143441784, 143454358, 143445951, 143444078, 143439885, 143435569, 143454046, 143441596, 143447082, 143443317, 143429509, 143436725, 143437906, 143450643, 143448749, 143441980, 143442835, 143444767, 143444268, 143453721, 143452909, 143458833, 143448647, 143454520, 143451507, 143443193, 143449624, 143449646, 143451425, 143446209, 143442012, 143437061, 143442188, 143447557, 143451915, 143447379, 143457815, 143443886, 143452998],
    8: [125218645, 125214016, 125214191, 125217429, 125207773, 125203928, 125203309, 125208524, 125215928, 125219723, 125222154, 125209103, 125209871, 125222456, 125228528, 125221506, 125225619, 125221970, 125227453, 125213206, 125216972, 125219161, 125213169, 125211150, 125213205, 125220332, 125215780, 125218955, 125221704, 125222298, 125215425, 125215016, 125215429, 125217736, 125212987, 125215548, 125219655, 125218446, 125212764, 125205460, 125204821, 125213961, 125215802, 125218627, 125211053, 125216419, 125214014, 125202641, 125207615, 125207978, 125208376, 125214489, 125210875, 125208262, 125209530, 125213102, 125214507, 125220290, 125215228, 125221165, 125212505, 125209716, 125212518, 125218794, 125217333, 125218926, 125223860, 125222953, 125220862, 125219359, 125211768, 125208543, 125217593, 125215693, 125210351, 125206227, 125205158, 125200441, 125208559, 125218152, 125219855, 125212415, 125212536, 125219272, 125219907, 125218466, 125219699, 125205610, 125212752, 125209362, 125208203, 125211587, 125212735, 125216424, 125208977, 125210534, 125200197, 125205263, 125210077, 125204616],
    9: [99848755, 99849270, 99845551, 99845528, 99854740, 99855486, 99855012, 99855016, 99856719, 99845274, 99849483, 99852651, 99854339, 99855138, 99853787, 99850832, 99850275, 99845068, 99846961, 99838193, 99838823, 99843784, 99843453, 99843718, 99847319, 99857346, 99852265, 99850888, 99849671, 99840149, 99840379, 99845843, 99844922, 99846220, 99846063, 99848312, 99849239, 99848803, 99851101, 99845730, 99841595, 99839317, 99840055, 99843257, 99841797, 99838853, 99842711, 99839969, 99841052, 99839823, 99838343, 99841593, 99838343, 99834136, 99829756, 99835522, 99835692, 99838233, 99836984, 99827595, 99832074, 99829069, 99831460, 99832028, 99834471, 99832581, 99831156, 99831104, 99833759, 99830169, 99821290, 99830271, 99831900, 99831472, 99827720, 99831344, 99828536, 99831083, 99827033, 99830455, 99830596, 99837184, 99835730, 99829208, 99830876, 99831428, 99837293, 99833646, 99829514, 99826770, 99822638, 99824189, 99824166, 99828156, 99822471, 99830236, 99822177, 99826754, 99831150, 99828912],
    10: [99848755, 99849270, 99845551, 99845528, 99854740, 99855486, 99855012, 99855016, 99856719, 99845274, 99849483, 99852651, 99854339, 99855138, 99853787, 99850832, 99850275, 99845068, 99846961, 99838193, 99838823, 99843784, 99843453, 99843718, 99847319, 99857346, 99852265, 99850888, 99849671, 99840149, 99840379, 99845843, 99844922, 99846220, 99846063, 99848312, 99849239, 99848803, 99851101, 99845730, 99841595, 99839317, 99840055, 99843257, 99841797, 99838853, 99842711, 99839969, 99841052, 99839823, 99838343, 99841593, 99838343, 99834136, 99829756, 99835522, 99835692, 99838233, 99836984, 99827595, 99832074, 99829069, 99831460, 99832028, 99834471, 99832581, 99831156, 99831104, 99833759, 99830169, 99821290, 99830271, 99831900, 99831472, 99827720, 99831344, 99828536, 99831083, 99827033, 99830455, 99830596, 99837184, 99835730, 99829208, 99830876, 99831428, 99837293, 99833646, 99829514, 99826770, 99822638, 99824189, 99824166, 99828156, 99822471, 99830236, 99822177, 99826754, 99831150, 99828912],
    11: [88506627, 88501220, 88503072, 88507857, 88509961, 88510203, 88505766, 88507575, 88503592, 88504870, 88502058, 88505628, 88511302, 88509816, 88509734, 88506011, 88503399, 88503177, 88501086, 88503636, 88503714, 88502242, 88505870, 88504435, 88507357, 88501811, 88502545, 88498411, 88504544, 88505906, 88505885, 88508567, 88502864, 88507440, 88509431, 88502662, 88506455, 88508006, 88506368, 88503515, 88503781, 88508598, 88507952, 88505998, 88506612, 88503751, 88503685, 88507504, 88509585, 88508225, 88506930, 88503050, 88505465, 88508483, 88510033, 88508903, 88509994, 88506012, 88509859, 88503741, 88508121, 88510783, 88509726, 88503498, 88503213, 88505386, 88508527, 88505089, 88503692, 88503077, 88506922, 88501070, 88505624, 88512022, 88509920, 88508343, 88505473, 88508169, 88503050, 88506502, 88503386, 88500904, 88501681, 88502403, 88503800, 88510094, 88503259, 88502772, 88508257, 88508318, 88513184, 88508088, 88508531, 88509348, 88516753, 88513926, 88512609, 88512737, 88510476, 88507663],
    12: [85329329, 85333001, 85330297, 85328463, 85324342, 85320703, 85324673, 85323807, 85325474, 85329833, 85327468, 85323340, 85331429, 85330547, 85330386, 85329305, 85320807, 85326854, 85329031, 85328409, 85324930, 85316719, 85318639, 85318675, 85317790, 85314001, 85314252, 85314214, 85326058, 85321778, 85321816, 85323886, 85325762, 85326420, 85323519, 85321460, 85326253, 85322756, 85321926, 85323022, 85319419, 85320568, 85321398, 85327381, 85330650, 85330801, 85330340, 85330899, 85329324, 85330876, 85326562, 85331429, 85339493, 85332852, 85332879, 85331835, 85335616, 85332694, 85336773, 85334081, 85332789, 85332673, 85335660, 85332998, 85336352, 85330267, 85334844, 85333759, 85334524, 85334571, 85337182, 85337861, 85337171, 85330685, 85326668, 85324916, 85325418, 85325338, 85330023, 85331339, 85326142, 85325614, 85326307, 85324848, 85330018, 85331927, 85333057, 85332075, 85333156, 85331715, 85331406, 85332007, 85329785, 85330530, 85333084, 85328974, 85325171, 85325311, 85323832, 85324363],
}

fig = plt.figure(figsize=(6.4, 4))
ax = fig.add_subplot(111)
formatter0 = EngFormatter(unit='Hz')
ax.set_xticks(range(1, 13))
ax.yaxis.set_major_formatter(formatter0)
ax.set_xlabel('stages')
ax.plot(data.keys(), list(map(mean, data.values())), 'rs', linestyle='--', label='frequency')

ax2 = ax.twinx()
formatter1 = EngFormatter(unit='s')
ax2.yaxis.set_major_formatter(formatter1)
ax2.plot(data.keys(), [1/(2*stages*mean(freq)) for stages, freq in data.items()], 'b^', linestyle='--', label='gate delay')

fig.legend(loc="upper right", bbox_to_anchor=(1,0.6), bbox_transform=ax.transAxes)

plt.show()
# plt.savefig('oscillator_speed.pgf')
